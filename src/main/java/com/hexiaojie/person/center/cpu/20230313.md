### <u>1.cpu突然飙高，系统反应慢怎么排查？ </u>

### 原因: 1.cpu上下文切换过多 2.资源过度消耗
>   同一时刻下每个cpu核心只能运行一个线程，如果有多个线程要执行，CPU只能通过上下文切换的方式来执行不同的线程。

>   CPU上下文切换：
> 1. 保持运行线程的执行状态
> 2. 让处于等待种的线程执行

> 1. java中：文件io、网络io、锁等待、线程阻塞等都会造成线程阻塞，从而触发cpu切换上下文
> 2. 创建了大量的线程，或者有线程长期占用cpu资源，无法被释放（死循环）

### 排查方法 
> 1. 使用top命令查看占用cpu资源较多的进程
> 2. shift + H 找到进程中cpu消耗较高的线程
#### 存在两种情况：
> 1. cpu利用率较高的是同一个线程: jstack获取线程的dump日志，定位到线程日志，找到对应的问题代码
> 2. cpu利用率较高的线程不断变化：挑选几个线程id，通过jstack去排查。这种情况大概率是：这一时刻用户访问量大，导致CPU飙高